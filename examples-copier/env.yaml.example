# Example environment variables for Google Cloud App Engine deployment
# Copy this file to env.yaml and fill in your actual values
# 
# ⚠️ IMPORTANT: Add env.yaml to .gitignore to prevent committing secrets!

env_variables:
  # =============================================================================
  # REQUIRED CONFIGURATION
  # =============================================================================
  
  # GitHub App Configuration
  GITHUB_APP_ID: "1166559"                    # Your GitHub App ID (numeric)
  INSTALLATION_ID: "62138132"                 # GitHub App Installation ID
  
  # Source Repository Configuration
  REPO_NAME: "docs-code-examples"             # Source repository name
  REPO_OWNER: "mongodb"                       # Source repository owner
  
  # Security Configuration
  # Path to GitHub App private key in Google Secret Manager
  GITHUB_APP_PRIVATE_KEY_SECRET_NAME: "projects/YOUR_PROJECT_ID/secrets/CODE_COPIER_PEM/versions/latest"

  # Webhook Secret Configuration (choose ONE of the following):
  # Option 1: Store webhook secret in Secret Manager (RECOMMENDED for production)
  WEBHOOK_SECRET_NAME: "projects/YOUR_PROJECT_ID/secrets/webhook-secret/versions/latest"
  # Option 2: Provide webhook secret directly (NOT recommended for production)
  # WEBHOOK_SECRET: "your-webhook-secret-here"
  
  # =============================================================================
  # OPTIONAL CONFIGURATION
  # =============================================================================
  
  # Committer Information
  COMMITTER_NAME: "GitHub Copier App"
  COMMITTER_EMAIL: "bot@mongodb.com"
  
  # Web Server Configuration
  PORT: "8080"                                # Server port (App Engine uses 8080 by default)
  WEBSERVER_PATH: "/events"                   # Webhook endpoint path
  
  # File Configuration
  CONFIG_FILE: "copier-config.yaml"           # Config file name in source repo
  DEPRECATION_FILE: "deprecated_examples.json" # Deprecation tracking file name
  
  # Source Branch
  SRC_BRANCH: "main"                          # Branch to monitor for changes
  
  # Google Cloud Configuration
  GOOGLE_PROJECT_ID: "YOUR_PROJECT_ID"        # GCP project ID for logging
  GOOGLE_LOG_NAME: "code-copier-log"          # Cloud Logging log name
  
  # Commit Strategy Defaults
  COPIER_COMMIT_STRATEGY: "direct"            # Default: "direct" or "pr"
  DEFAULT_COMMIT_MESSAGE: "Update code examples from source repository"
  DEFAULT_RECURSIVE_COPY: "true"              # Default recursive copy behavior
  DEFAULT_PR_MERGE: "false"                   # Default auto-merge PR behavior
  
  # Request Configuration
  REQUEST_TIMEOUT_SECONDS: "300"              # Webhook request timeout (5 minutes)
  
  # Logging Configuration
  LOG_LEVEL: "info"                           # Log level: debug, info, warn, error
  COPIER_DISABLE_CLOUD_LOGGING: "false"       # Set to "true" to disable Cloud Logging

# =============================================================================
# NOTES
# =============================================================================
#
# 1. GitHub App Private Key:
#    Store your GitHub App private key in Google Secret Manager:
#    
#    gcloud secrets create CODE_COPIER_PEM \
#      --data-file=/path/to/private-key.pem \
#      --replication-policy="automatic"
#    
#    Grant App Engine access:
#    gcloud secrets add-iam-policy-binding CODE_COPIER_PEM \
#      --member="serviceAccount:YOUR_PROJECT_ID@appspot.gserviceaccount.com" \
#      --role="roles/secretmanager.secretAccessor"
#
# 2. Webhook Secret:
#    Option A: Store in Secret Manager (RECOMMENDED):
#
#    # Generate a secure random string
#    openssl rand -hex 32
#
#    # Store in Secret Manager
#    echo -n "YOUR_GENERATED_SECRET" | gcloud secrets create webhook-secret \
#      --data-file=- \
#      --replication-policy="automatic"
#
#    # Grant App Engine access
#    gcloud secrets add-iam-policy-binding webhook-secret \
#      --member="serviceAccount:YOUR_PROJECT_ID@appspot.gserviceaccount.com" \
#      --role="roles/secretmanager.secretAccessor"
#
#    # Use WEBHOOK_SECRET_NAME in env.yaml
#    WEBHOOK_SECRET_NAME: "projects/YOUR_PROJECT_ID/secrets/webhook-secret/versions/latest"
#
#    Option B: Provide directly (NOT recommended for production):
#
#    # Use WEBHOOK_SECRET in env.yaml
#    WEBHOOK_SECRET: "your-generated-secret-here"
#
#    Use the same secret in your GitHub webhook configuration.
#
# 3. Deployment:
#    Deploy using:
#    
#    gcloud app deploy app.yaml --env-vars-file=env.yaml
#    
#    Or use the deployment script:
#    
#    ./deploy.sh
#
# 4. Security:
#    - Never commit env.yaml to version control
#    - Add env.yaml to .gitignore
#    - Rotate secrets regularly
#    - Use least-privilege IAM roles
#
# =============================================================================

